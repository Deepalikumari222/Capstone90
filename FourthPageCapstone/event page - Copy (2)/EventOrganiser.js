
let events = [

    {
        title: "Spandan",
        category: "cultural",
        date: "2025-03-31T17:00:00",
        venue: "Main Auditorium",
        organizer: "Cultural Club",
        registerLink: "https://forms.gle/xyz",
        teamsLink: null
    },
  

  

  
    {
        title: "XYX",
        category: "clubs",
        date: "2025-04-01T15:00:00",
        venue: "Cafeteria",
        organizer: "Zaika: The Culinary Club",
        registerLink: "https://forms.gle/zaika1",
        teamsLink: null
    },
    {
        title: "Bonanza",
        category: "clubs",
        date: "2025-04-08T14:00:00",
        venue: "Open Grounds",
        organizer: "Zaika: The Culinary Club",
        registerLink: "https://forms.gle/zaika2",
        teamsLink: null
    },
    
    {
        title: "Valorant ",
        category: "clubs",
        date: "2025-04-02T18:00:00",
        venue: "Online (Teams)",
        organizer: "ELite Arena: Gaming Club",
        registerLink: "https://forms.gle/elite1",
        teamsLink: "https://teams.microsoft.com/elite1"
    },
    {
        title: "FIFA",
        category: "clubs",
        date: "2025-04-09T16:00:00",
        venue: "Gaming Lounge",
        organizer: "ELite Arena: Gaming Club",
        registerLink: "https://forms.gle/elite2",
        teamsLink: null
    },
    
    {
        title: "Anime",
        category: "clubs",
        date: "2025-04-03T17:00:00",
        venue: "Seminar Hall",
        organizer: "Hikaru: The Anime Club",
        registerLink: "https://forms.gle/hikaru1",
        teamsLink: null
    },
    {
        title: "Cosplay",
        category: "clubs",
        date: "2025-04-10T15:00:00",
        venue: "Main Stage",
        organizer: "Hikaru: The Anime Club",
        registerLink: "https://forms.gle/hikaru2",
        teamsLink: null
    },
    
    {
        title: "Painting",
        category: "clubs",
        date: "2025-04-04T10:00:00",
        venue: "Art Room",
        organizer: "Srijan: The Fine Arts Club",
        registerLink: "https://forms.gle/srijan1",
        teamsLink: null
    },
    {
        title: "Sketching",
        category: "clubs",
        date: "2025-04-11T14:00:00",
        venue: "Open Grounds",
        organizer: "Srijan: The Fine Arts Club",
        registerLink: "https://forms.gle/srijan2",
        teamsLink: null
    },
    
    {
        title: "Poetry",
        category: "clubs",
        date: "2025-04-05T16:00:00",
        venue: "Library Hall",
        organizer: "Alfaaz: The Literary Club",
        registerLink: "https://forms.gle/alfaaz1",
        teamsLink: null
    },
    {
        title: "Story",
        category: "clubs",
        date: "2025-04-12T11:00:00",
        venue: "Online (Teams)",
        organizer: "Alfaaz: The Literary Club",
        registerLink: "https://forms.gle/alfaaz2",
        teamsLink: "https://teams.microsoft.com/alfaaz2"
    },
 
    {
        title: "Fashion",
        category: "clubs",
        date: "2025-04-06T18:00:00",
        venue: "Main Stage",
        organizer: "Radiance: The Fashion Club",
        registerLink: "https://forms.gle/radiance1",
        teamsLink: null
    },
    {
        title: "DIY",
        category: "clubs",
        date: "2025-04-13T15:00:00",
        venue: "Design Studio",
        organizer: "Radiance: The Fashion Club",
        registerLink: "https://forms.gle/radiance2",
        teamsLink: null
    },
 
    {
        title: "Stand-Up ",
        category: "clubs",
        date: "2025-04-07T19:00:00",
        venue: "Auditorium",
        organizer: "Latent: The Comedy Club",
        registerLink: "https://forms.gle/latent1",
        teamsLink: null
    },
    {
        title: "Improv",
        category: "clubs",
        date: "2025-04-14T16:00:00",
        venue: "Online (Teams)",
        organizer: "Latent: The Comedy Club",
        registerLink: "https://forms.gle/latent2",
        teamsLink: "https://teams.microsoft.com/latent2"
    },
    
    {
        title: "Melody",
        category: "clubs",
        date: "2025-04-08T18:00:00",
        venue: "Open Amphitheater",
        organizer: "Sargam: The Music Club",
        registerLink: "https://forms.gle/sargam1",
        teamsLink: null
    },
    {
        title: "Instrumental",
        category: "clubs",
        date: "2025-04-15T17:00:00",
        venue: "Music Room",
        organizer: "Sargam: The Music Club",
        registerLink: "https://forms.gle/sargam2",
        teamsLink: null
    },
    
    {
        title: "Dance",
        category: "clubs",
        date: "2025-04-09T17:00:00",
        venue: "Main Stage",
        organizer: "Vibencia: The Dance Club",
        registerLink: "https://forms.gle/vibencia1",
        teamsLink: null
    },
    {
        title: "Bollywood",
        category: "clubs",
        date: "2025-04-16T15:00:00",
        venue: "Dance Studio",
        organizer: "Vibencia: The Dance Club",
        registerLink: "https://forms.gle/vibencia2",
        teamsLink: null
    },
    
    {
        title: "Photo",
        category: "clubs",
        date: "2025-04-10T08:00:00",
        venue: "Campus Grounds",
        organizer: "Chalchitra: The Photography Club",
        registerLink: "https://forms.gle/chalchitra1",
        teamsLink: null
    },
    {
        title: "Photography",
        category: "clubs",
        date: "2025-04-17T14:00:00",
        venue: "Art Gallery",
        organizer: "Chalchitra: The Photography Club",
        registerLink: "https://forms.gle/chalchitra2",
        teamsLink: null
    },
    
    {
        title: "Street Play",
        category: "clubs",
        date: "2025-04-11T16:00:00",
        venue: "Open Grounds",
        organizer: "Dramonix: The Drama Club",
        registerLink: "https://forms.gle/dramonix1",
        teamsLink: null
    },
    {
        title: "Theater",
        category: "clubs",
        date: "2025-04-18T10:00:00",
        venue: "Auditorium",
        organizer: "Dramonix: The Drama Club",
        registerLink: "https://forms.gle/dramonix2",
        teamsLink: null
    }
];


const categoryIcons = {
    tech: "fa-laptop-code",
    cultural: "fa-theater-masks",
    sports: "fa-futbol",
    academic: "fa-book",
    workshops: "fa-tools",
    hackathons: "fa-code",
    clubs: "fa-users" 
};


function getCountdown(eventDate) {
    const now = new Date();
    const eventTime = new Date(eventDate);
    const diff = eventTime - now;

    if (diff <= 0) return "Event Started!";
    const days = Math.floor(diff / (1000 * 60 * 60 * 24));
    const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
    const mins = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
    return `${days}d ${hours}h ${mins}m`;
}


function renderEvents(filteredEvents) {
    const container = document.getElementById("events-container");
    container.innerHTML = "";

    filteredEvents.forEach((event, index) => {
        const card = document.createElement("div");
        card.classList.add("event-card");
        card.innerHTML = `
            <div class="card-overlay"></div>
            <div class="card-content">
                <span class="category-badge">${event.category}</span>
                <div class="card-header">
                    <div class="category-icon"><i class="fas ${categoryIcons[event.category] || 'fa-calendar'}"></i></div>
                    <h3>${event.title}</h3>
                </div>
                <div class="details">
                    <p><strong>Date:</strong> ${new Date(event.date).toLocaleString()}</p>
                    <p><strong>Venue:</strong> ${event.venue}</p>
                    <p><strong>Organizer:</strong> ${event.organizer}</p>
                </div>
                <p class="countdown"><i class="fas fa-clock"></i> ${getCountdown(event.date)}</p>
                <div class="buttons">
                    <a href="${event.registerLink}" target="_blank" class="register-btn">Register Now</a>
                    ${event.teamsLink ? `<a href="${event.teamsLink}" target="_blank" class="teams-btn"><i class="fas fa-video"></i> Teams Meeting</a>` : ''}
                    <button class="update-btn" data-index="${index}">Update</button>
                    <button class="cancel-btn" data-index="${index}">Cancel</button>
                </div>
            </div>
        `;
        container.appendChild(card);
    });

    
    document.querySelectorAll(".update-btn").forEach(btn => {
        btn.addEventListener("click", (e) => {
            const index = e.target.getAttribute("data-index");
            openUpdateModal(index);
        });
    });

    document.querySelectorAll(".cancel-btn").forEach(btn => {
        btn.addEventListener("click", (e) => {
            const index = e.target.getAttribute("data-index");
            openCancelModal(index);
        });
    });
}


function filterEvents() {
    const category = document.getElementById("category-filter").value;
    const search = document.getElementById("search-bar").value.toLowerCase();

    const filtered = events.filter(event => {
        const matchesCategory = category === "all" || event.category === category;
        const matchesSearch = event.title.toLowerCase().includes(search) || 
                             event.venue.toLowerCase().includes(search) || 
                             event.organizer.toLowerCase().includes(search);
        return matchesCategory && matchesSearch;
    });

    renderEvents(filtered);
}


const addModal = document.getElementById("add-event-modal");
const addEventBtn = document.getElementById("add-event-btn");
const closeAddModal = document.getElementById("close-modal");
const addEventForm = document.getElementById("add-event-form");

addEventBtn.addEventListener("click", () => {
    addModal.style.display = "block";
});

closeAddModal.addEventListener("click", () => {
    addModal.style.display = "none";
});

window.addEventListener("click", (event) => {
    if (event.target === addModal) {
        addModal.style.display = "none";
    }
});

addEventForm.addEventListener("submit", (e) => {
    e.preventDefault();
    const newEvent = {
        title: document.getElementById("event-title").value,
        category: document.getElementById("event-category").value,
        date: document.getElementById("event-date").value,
        venue: document.getElementById("event-venue").value,
        organizer: document.getElementById("event-organizer").value,
        registerLink: document.getElementById("event-link").value,
        teamsLink: document.getElementById("event-venue").value.toLowerCase().includes("online") ? "https://teams.microsoft.com/new" : null
    };
    events.push(newEvent);
    filterEvents();
    addModal.style.display = "none";
    addEventForm.reset();
});

const updateModal = document.getElementById("update-event-modal");
const closeUpdateModal = document.getElementById("close-update-modal");
const updateEventForm = document.getElementById("update-event-form");

function openUpdateModal(index) {
    const event = events[index];
    document.getElementById("update-event-index").value = index;
    document.getElementById("update-event-title").value = event.title;
    document.getElementById("update-event-category").value = event.category;
    document.getElementById("update-event-date").value = event.date.slice(0, 16);
    document.getElementById("update-event-venue").value = event.venue;
    document.getElementById("update-event-organizer").value = event.organizer;
    document.getElementById("update-event-link").value = event.registerLink;
    updateModal.style.display = "block";
}

closeUpdateModal.addEventListener("click", () => {
    updateModal.style.display = "none";
});

window.addEventListener("click", (event) => {
    if (event.target === updateModal) {
        updateModal.style.display = "none";
    }
});

updateEventForm.addEventListener("submit", (e) => {
    e.preventDefault();
    const index = document.getElementById("update-event-index").value;
    events[index] = {
        title: document.getElementById("update-event-title").value,
        category: document.getElementById("update-event-category").value,
        date: document.getElementById("update-event-date").value,
        venue: document.getElementById("update-event-venue").value,
        organizer: document.getElementById("update-event-organizer").value,
        registerLink: document.getElementById("update-event-link").value,
        teamsLink: document.getElementById("update-event-venue").value.toLowerCase().includes("online") ? "https://teams.microsoft.com/updated" : null
    };
    filterEvents();
    updateModal.style.display = "none";
    updateEventForm.reset();
});


const cancelModal = document.getElementById("cancel-event-modal");
const closeCancelModal = document.getElementById("close-cancel-modal");
const confirmCancelBtn = document.getElementById("confirm-cancel-btn");
const cancelCancelBtn = document.getElementById("cancel-cancel-btn");

function openCancelModal(index) {
    document.getElementById("cancel-event-index").value = index;
    cancelModal.style.display = "block";
}

closeCancelModal.addEventListener("click", () => {
    cancelModal.style.display = "none";
});

window.addEventListener("click", (event) => {
    if (event.target === cancelModal) {
        cancelModal.style.display = "none";
    }
});

confirmCancelBtn.addEventListener("click", () => {
    const index = document.getElementById("cancel-event-index").value;
    events.splice(index, 1);
    filterEvents();
    cancelModal.style.display = "none";
});

cancelCancelBtn.addEventListener("click", () => {
    cancelModal.style.display = "none";
});


document.getElementById("category-filter").addEventListener("change", filterEvents);
document.getElementById("search-bar").addEventListener("input", filterEvents);


renderEvents(events);


setInterval(() => {
    filterEvents();
}, 1000);